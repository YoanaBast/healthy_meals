{% extends 'base.html' %}
{% load static %}


{% block title %}
Add Recipe
{% endblock %}

{% block content %}

<div id="recipe-meta"
     data-mode="add"
     style="display:none;">
</div>

<div class="container-home" style="padding-top: 2rem; padding-bottom: 2rem;">
    <a href="javascript:history.back()" class="btn">Back</a>
</div>

<div class="container-home">
    <form method="post" action="{% url 'add_recipe' %}" novalidate>
        {% csrf_token %}
        {% include "core/errors_label.html" with form=recipe_form %}

        {{ ingredient_formset.management_form }}

        <h2>Add Recipe</h2>

        <div class="grid-container">
            <div class="grid-item info">
                <p>{{ recipe_form.name.label_tag }} {{ recipe_form.name }}</p>

<!-- Category -->
<p>
    {{ recipe_form.category.label_tag }}
    <div style="display:flex; align-items:center; gap:0.4rem;">
        {{ recipe_form.category }}
        <button type="button" class="btn btn-small" title="Add new category"
            onclick="openQuickModal('Add Recipe Category', '{% url "add_recipe_category_ajax" %}', 'id_category')">+</button>
        <button type="button" class="btn btn-small" title="Manage categories"
            onclick="fetchAndManage('{% url "list_recipe_categories_ajax" %}', 'Manage Categories')">â‹¯</button>
    </div>
</p>

                <p>{{ recipe_form.servings.label_tag }} {{ recipe_form.servings }}</p>
            </div>

            <div class="grid-item info">
                <p>
                    <label>Cooking Time:</label>
                    <span class="time-inputs">
                        {{ recipe_form.hours }} h
                        {{ recipe_form.minutes }} m
                    </span>
                </p>
                <p>{{ recipe_form.instructions.label_tag }} {{ recipe_form.instructions }}</p>
            </div>
        </div>


        <h3>Ingredients</h3>
        <div id="ingredientsContainer"></div>

        {% include 'core/add_button.html' %}

        <br><br>

        <button type="submit" class="btn btn-success">Save Recipe</button>
        <a href="{% url 'manage_recipes' %}" class="btn btn-secondary">Cancel</a>

    </form>
</div>

{% include 'recipes/add_ingredients_to_recipe_modal.html' %}
{% include 'core/_quick_add_modal.html' %}
{% include 'core/_manage_list_modal.html' %}

<script src="{% static 'js/add_recipe_handler.js' %}"></script>
<script src="{% static 'js/zero_inputt_handler.js' %}"></script>
<script src="{% static 'js/fetch_and_manage.js' %}"></script>


{% endblock %}