{% load static %}
{% load core_filters %}

<div id="addFridgeItemModal" class="recipe-modal" style="display:none;">
    <div class="recipe-modal-content">
        <h4>Add to Fridge</h4>

        <form id="addFridgeItemForm" method="post" action="{% url 'add_fridge_item' %}" novalidate>
            {% csrf_token %}
                {% include "core/errors_label.html" %}

            <!-- Ingredient Dropdown -->
            <label for="ingredientSelect">Ingredient</label>
            <select id="ingredientSelect" name="ingredient_id" onchange="loadUnits()">
                <option value="">Select ingredient</option>
                {% for ing in ingredients %}
                    <option value="{{ ing.id }}"
                        data-units='[
                            {% for rel in ing.measurement_units.all %}
                                {"id": "{{ rel.unit.id }}", "name": "{{ rel.unit.name_singular|escapejs }}"}{% if not forloop.last %},{% endif %}
                            {% endfor %}
                        ]'
                    >{{ ing.name|title_except }}</option>
                {% endfor %}
            </select>

            <br><br>

            <!-- Quantity -->
            <label for="quantityInput">Quantity</label>
            <input type="number" id="quantityInput" name="quantity" step="0.01" min="0.01" placeholder="Quantity">

            <br><br>

            <!-- Unit Dropdown -->
            <label for="unitSelect">Unit</label>
            <select id="unitSelect" name="unit"></select>

            <br><br>

            <button type="submit" class="btn btn-success">Add to Fridge</button>
            <button type="button" onclick="closeModal()" class="btn btn-secondary">Cancel</button>
        </form>
    </div>
</div>


