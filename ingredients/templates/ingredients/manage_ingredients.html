{% extends 'base.html' %}
{% load static %}
{% load form_extras %}
{% load core_filters %}

{% block title %}Manage Ingredients{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/ingredient_forms_styles.css' %}">


<div class="container-home">

    <div id="manage-ingredients" class="tab-content active">


        <!-- Title + Button Row -->
        <div class="section-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem;">
            <div>
                <h2 class="section-title">Manage Ingredients</h2>
                <p class="section-description">What ingredients do you want to use? Manage them here!</p>
            </div>

        <a href="{% url 'add_ingredient' %}" class="btn">Add Ingredient</a>

        </div>



        <!-- DELETE POPUP -->
        {% include 'ingredients/delete_ingredient_modal.html' %}


        <!-- Table with all ingredients -->
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Ingredient Name</th>
                            <th>Category</th>
                            <th>Dietary Information</th>
                            <th>Default Unit</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                        <tbody>
                            {% for ing in ingredients %}
                            <tr>
                                <td data-label="Ingredient Name">{{ ing.name|title_except }}</td>
                                <td data-label="Category">{{ ing.category|default:"-" }}</td>
                                <td data-label="Dietary Information"> {{ ing.dietary_info|default:"-" }}</td>
                                <td data-label="Default Unit">{{ ing.default_unit }}</td>
                                <td data-label="Actions">
                                    <div class="action-buttons">
                                        <a href="{% url 'ingredient_detail' ing.id %}" class="btn btn-secondary btn-small">Details</a>
                                        <a href="{% url 'edit_ingredient' ing.id %}" class="btn btn-secondary btn-small">Edit</a>
<button type="button"
        class="icon-delete-btn"
        onclick="openDeleteModal('ingredient', {{ ing.id }}, '{{ ing.name|escapejs }}')">

    <img src="{% static 'images/delete-trash.svg' %}"
         alt="Delete">
</button>
                                    </div>
                                </td>


                            {% empty %}
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 2rem;">
                                    <h2 style="margin: 0;">No ingredients yet...</h2>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                </table>
        <!-- Pagination -->
        {% if ingredients.has_other_pages %}
        <div class="pagination" style="margin-top:1rem; text-align:center;">
            {% if ingredients.has_previous %}
                <a href="?page={{ ingredients.previous_page_number }}">« Previous</a>
            {% endif %}

            <span>Page {{ ingredients.number }} of {{ ingredients.paginator.num_pages }}</span>

            {% if ingredients.has_next %}
                <a href="?page={{ ingredients.next_page_number }}">Next »</a>
            {% endif %}
        </div>
        {% endif %}

    </div>
</div>

<!-- Script for quick save on popup -->

<script src="{% static 'js/zero_inputt_handler.js' %}"></script>
<script src="{% static 'js/delete_popup.js' %}"></script>

{% endblock %}
